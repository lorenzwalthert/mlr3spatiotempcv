<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • mlr3spatiotempcv</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../extra.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="mlr3spatiotempcv">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://mlr-org.com"><img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" id="hexlogo" alt="mlr-org"></a>
        <a class="navbar-brand" href="../index.html">mlr3spatiotempcv <small>v0.0.0.9007</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa fa fa-file-alt"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://mlr3book.mlr-org.com">
    <span class="fa fa fa fa-link"></span>
     
    mlr3book
  </a>
</li>
<li>
  <a href="../articles/mlr3spatiotempcv.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/spatiotemp-viz.html">Spatiotemporal Visualization</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/mlr-org/mlr3spatiotempcv/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mlr3spatiotempcv_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3spatiotempcv/blob/master/vignettes/mlr3spatiotempcv.Rmd"><code>vignettes/mlr3spatiotempcv.Rmd</code></a></small>
      <div class="hidden name"><code>mlr3spatiotempcv.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">42</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mlr3"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mlr3spatiotempcv"</span>)</pre></body></html></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This package provides resampling methods for the {mlr3} package framework suited for spatial and temporal data.</p>
<p>After attaching the namespace via <code><a href="https://mlr3spatiotempcv.mlr-org.com/reference">library("mlr3spatiotempcv")</a></code>, the spatial resampling methods and example tasks provided by {mlr3spatiotempcv} are available to the user.</p>
<p>This can be verified by printing the mlr3 dictionaries which got extended after loading {mlr3spatiotempcv}:</p>
<div id="task-types" class="section level3">
<h3 class="hasAnchor">
<a href="#task-types" class="anchor"></a>Task types</h3>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">mlr_reflections</span>$<span class="no">task_types</span>
<span class="co">#&gt;       type          package          task        learner        prediction</span>
<span class="co">#&gt; 1: classif             mlr3   TaskClassif LearnerClassif PredictionClassif</span>
<span class="co">#&gt; 2: classif mlr3spatiotempcv TaskClassifST LearnerClassif PredictionClassif</span>
<span class="co">#&gt; 3:    regr             mlr3      TaskRegr    LearnerRegr    PredictionRegr</span>
<span class="co">#&gt; 4:    regr mlr3spatiotempcv    TaskRegrST    LearnerRegr    PredictionRegr</span>
<span class="co">#&gt;           measure</span>
<span class="co">#&gt; 1: MeasureClassif</span>
<span class="co">#&gt; 2: MeasureClassif</span>
<span class="co">#&gt; 3:    MeasureRegr</span>
<span class="co">#&gt; 4:    MeasureRegr</span></pre></body></html></div>
</div>
<div id="task-column-roles" class="section level3">
<h3 class="hasAnchor">
<a href="#task-column-roles" class="anchor"></a>Task column roles</h3>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># note the additional "coordinates" slot</span>
<span class="no">mlr_reflections</span>$<span class="no">task_col_roles</span>
<span class="co">#&gt; $regr</span>
<span class="co">#&gt; [1] "feature"     "target"      "label"       "order"       "group"      </span>
<span class="co">#&gt; [6] "weight"      "coordinates"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $classif</span>
<span class="co">#&gt; [1] "feature"     "target"      "label"       "order"       "group"      </span>
<span class="co">#&gt; [6] "weight"      "coordinates"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $classif_st</span>
<span class="co">#&gt; [1] "feature"     "target"      "label"       "order"       "group"      </span>
<span class="co">#&gt; [6] "weight"      "coordinates" "coordinates"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $regr_st</span>
<span class="co">#&gt; [1] "feature"     "target"      "label"       "order"       "group"      </span>
<span class="co">#&gt; [6] "weight"      "coordinates" "coordinates"</span></pre></body></html></div>
</div>
<div id="resampling-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#resampling-methods" class="anchor"></a>Resampling methods</h3>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://mlr3.mlr-org.com/reference/as.data.table.html">as.data.table</a></span>(<span class="no">mlr_resamplings</span>)
<span class="co">#&gt;                      key                                  params iters</span>
<span class="co">#&gt;  1:            bootstrap                           repeats,ratio    30</span>
<span class="co">#&gt;  2:               custom                                             0</span>
<span class="co">#&gt;  3:                   cv                                   folds    10</span>
<span class="co">#&gt;  4:              holdout                                   ratio     1</span>
<span class="co">#&gt;  5:             insample                                             1</span>
<span class="co">#&gt;  6:                  loo                                            NA</span>
<span class="co">#&gt;  7:          repeated_cv                           repeats,folds   100</span>
<span class="co">#&gt;  8:  repeated_spcv_block folds,repeats,rows,cols,range,selection    10</span>
<span class="co">#&gt;  9: repeated_spcv_coords                           folds,repeats    10</span>
<span class="co">#&gt; 10:    repeated_spcv_env                  folds,repeats,features    10</span>
<span class="co">#&gt; 11: repeated_sptcv_cluto                           folds,repeats    10</span>
<span class="co">#&gt; 12:  repeated_sptcv_cstf                           folds,repeats    10</span>
<span class="co">#&gt; 13:           spcv_block         folds,rows,cols,range,selection    10</span>
<span class="co">#&gt; 14:          spcv_buffer               theRange,spDataType,addBG     0</span>
<span class="co">#&gt; 15:          spcv_coords                                   folds    10</span>
<span class="co">#&gt; 16:             spcv_env                          folds,features    10</span>
<span class="co">#&gt; 17:          sptcv_cluto                                   folds    10</span>
<span class="co">#&gt; 18:           sptcv_cstf                                   folds    10</span>
<span class="co">#&gt; 19:          subsampling                           repeats,ratio    30</span></pre></body></html></div>
<p>The following HTML table lists the implemented methods in a more appealing way:</p>
<table class="table">
<colgroup>
<col width="39%">
<col width="12%">
<col width="15%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th>Literature</th>
<th>Package</th>
<th>Reference</th>
<th>mlr3 Sugar</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Spatial Buffering</td>
<td>blockCV</td>
<td>Valavi 2019</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("spcv_buffer")</a></code></td>
</tr>
<tr class="even">
<td>Spatial Blocking</td>
<td>blockCV</td>
<td>Valavi 2019</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("spcv_block")</a></code></td>
</tr>
<tr class="odd">
<td>Spatial CV</td>
<td>sperrorest</td>
<td>Brenning 2012</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("spcv_coords")</a></code></td>
</tr>
<tr class="even">
<td>Environmental Blocking</td>
<td>blockCV</td>
<td>Valavi 2019</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("spcv_env")</a></code></td>
</tr>
<tr class="odd">
<td>-</td>
<td>-</td>
<td>-</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("sptcv_cluto")</a></code></td>
</tr>
<tr class="even">
<td>Leave-Location-and-Time-Out</td>
<td>CAST</td>
<td>Meyer 2018</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("sptcv_cstf")</a></code></td>
</tr>
<tr class="odd">
<td>—</td>
<td>—</td>
<td>—</td>
<td>—</td>
</tr>
<tr class="even">
<td>Repeated Spatial Blocking</td>
<td>blockCV</td>
<td>Valavi 2019</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("repeated_spcv_block")</a></code></td>
</tr>
<tr class="odd">
<td>Repeated Spatial CV</td>
<td>sperrorest</td>
<td>Brenning 2012</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("repeated_spcv_coords")</a></code></td>
</tr>
<tr class="even">
<td>Repeated Env Blocking</td>
<td>blockCV</td>
<td>Valavi 2019</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("repeated_spcv_env")</a></code></td>
</tr>
<tr class="odd">
<td>-</td>
<td>-</td>
<td>-</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("repeated_sptcv_cluto")</a></code></td>
</tr>
<tr class="even">
<td>Repeated Leave-Location-and-Time-Out</td>
<td>CAST</td>
<td>Meyer 2018</td>
<td><code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp("repeated_sptcv_cstf")</a></code></td>
</tr>
</tbody>
</table>
</div>
<div id="creating-a-spatiotemporal-task-from-scratch" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-spatiotemporal-task-from-scratch" class="anchor"></a>Creating a spatiotemporal task from scratch</h2>
<p>{mlr3spatiotempcv} comes with two specific Task classes, namely <code>TaskClassifST</code> (for classification) and <code>TaskRegrST</code> (for regression tasks). In order to create such a task, you need at least a set of spatial coordinates (x, y) to spatially locate your observations.</p>
<p>During construction it can be can specified whether the coordinates should be used as features during modeling or not. By default, coordinates are not used as features and will be removed from the feature dataset after the coordinates have been added as a method to the task.</p>
<p>It is good practice to also provide a coordinate reference system (CRS) along with the coordinates. If none is set, EPSG 4326 (WGS84) will be used as a fallback for plotting purposes. Note however that not providing a CRS during construction might lead to substantial spatial offsets.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">data</span> <span class="kw">=</span> <span class="kw pkg">mlr3</span><span class="kw ns">::</span><span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_data_backend.html">as_data_backend</a></span>(<span class="no">ecuador</span>)

<span class="no">ecuador</span> <span class="kw">=</span> <span class="no">TaskClassifST</span>$<span class="fu">new</span>(
  <span class="kw">id</span> <span class="kw">=</span> <span class="st">"ecuador"</span>, <span class="kw">backend</span> <span class="kw">=</span> <span class="no">data</span>, <span class="kw">target</span> <span class="kw">=</span> <span class="st">"slides"</span>,
  <span class="kw">positive</span> <span class="kw">=</span> <span class="st">"TRUE"</span>, <span class="kw">coordinate_names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="kw">coords_as_features</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">crs</span> <span class="kw">=</span> <span class="st">"+proj=utm +zone=17 +south +datum=WGS84 +units=m +no_defs"</span>)</pre></body></html></div>
<p>The “ecuador” dataset consists of a response variable named <code>slides</code> (boolean; see Figure @ref(fig:lsl)) and various predictor variables that might have an influence on the occurrence of landslides such as slope, curvature or catchment area.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> For a detailed overview of the dataset, please refer to <span class="citation">Brenning et al. (<a href="#ref-brenning_landslide_2015" role="doc-biblioref">2015</a>)</span> and/or Chapter 11 of <a href="https://geocompr.robinlovelace.net/spatial-cv.html">Geocomputation with R</a> <span class="citation">(Lovelace, Nowosad, and Muenchow <a href="#ref-lovelace_geocomputation_2019" role="doc-biblioref">2019</a>)</span>.</p>
<div class="figure" style="text-align: center">
<img src="https://geocompr.robinlovelace.net/figures/lsl-map-1.png" alt="Fig.1: Landslide initiation points (red) and non-landslide points (blue) in Southern Ecuador. Figure taken from @lovelace_geocomputation_2019." width="70%"><p class="caption">
Fig.1: Landslide initiation points (red) and non-landslide points (blue) in Southern Ecuador. Figure taken from <span class="citation">Lovelace, Nowosad, and Muenchow (<a href="#ref-lovelace_geocomputation_2019" role="doc-biblioref">2019</a>)</span>.
</p>
</div>
</div>
<div id="task-properties" class="section level2">
<h2 class="hasAnchor">
<a href="#task-properties" class="anchor"></a>Task properties</h2>
<p>Spatiotemporal tasks share all properties of a normal classification or regression task. In addition, they store the coordinates alongside the dataset. They can be retrieved via the active binding <code>$coordinates()</code>. Printing a spatial task, also displays a preview of the coordinates.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">ecuador</span>
<span class="co">#&gt; &lt;TaskClassifST:ecuador&gt; (751 x 11)</span>
<span class="co">#&gt; * Target: slides</span>
<span class="co">#&gt; * Properties: twoclass</span>
<span class="co">#&gt; * Features (10):</span>
<span class="co">#&gt;   - dbl (10): carea, cslope, dem, distdeforest, distroad,</span>
<span class="co">#&gt;     distslidespast, hcurv, log.carea, slope, vcurv</span>
<span class="co">#&gt; * Coordinates:</span>
<span class="co">#&gt;             x       y</span>
<span class="co">#&gt;   1: 712882.5 9560002</span>
<span class="co">#&gt;   2: 715232.5 9559582</span>
<span class="co">#&gt;   3: 715392.5 9560172</span>
<span class="co">#&gt;   4: 715042.5 9559312</span>
<span class="co">#&gt;   5: 715382.5 9560142</span>
<span class="co">#&gt;  ---                 </span>
<span class="co">#&gt; 747: 714472.5 9558482</span>
<span class="co">#&gt; 748: 713142.5 9560992</span>
<span class="co">#&gt; 749: 713322.5 9560562</span>
<span class="co">#&gt; 750: 715392.5 9557932</span>
<span class="co">#&gt; 751: 713802.5 9560862</span></pre></body></html></div>
<p>After the task has been constructed, it can be used in conjunction with all available resampling methods, including non-spatial ones.</p>
<p>Note however that non-spatial methods should <strong>only be used to showcase the degree of overoptimistic performance estimates</strong> when compared to spatiotemporal resampling methods <span class="citation">(Schratz et al. <a href="#ref-schratz2019" role="doc-biblioref">2019</a>)</span>.</p>
<div id="spatiotemporal-resampling" class="section level3">
<h3 class="hasAnchor">
<a href="#spatiotemporal-resampling" class="anchor"></a>Spatiotemporal resampling</h3>
<p>To stay close to upstream <a href="https://mlr3book.mlr-org.com/resampling.html">resampling example of the mlr3book</a>, this example will use the “ecuador” example task which comes bundled with the {mlr3spatiotempcv} package.</p>
<p>The goal of this usecase is to predict landslide occurrence using a simple decision tree. To showcase that standard, i.e., non-spatial, cross-validation usually shows an over-optimistic performance, first a 5-repeated 5-fold cross-validation will be performed, using the <code>"repeated-cv"</code> resampling method.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">learner</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span>(<span class="st">"classif.rpart"</span>, <span class="kw">maxdepth</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">predict_type</span> <span class="kw">=</span> <span class="st">"prob"</span>)
<span class="no">resampling_nsp</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp</a></span>(<span class="st">"repeated_cv"</span>, <span class="kw">folds</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">repeats</span> <span class="kw">=</span> <span class="fl">5</span>)
<span class="no">rr_nsp</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/resample.html">resample</a></span>(
  <span class="kw">task</span> <span class="kw">=</span> <span class="no">ecuador</span>, <span class="kw">learner</span> <span class="kw">=</span> <span class="no">learner</span>,
  <span class="kw">resampling</span> <span class="kw">=</span> <span class="no">resampling_nsp</span>)

<span class="no">rr_nsp</span>$<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="kw">measures</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">msr</a></span>(<span class="st">"classif.ce"</span>))
<span class="co">#&gt; classif.ce </span>
<span class="co">#&gt;  0.3408706</span></pre></body></html></div>
<p>Yet the “ecuador” landslides dataset is a spatial dataset, i.e., that each observation comes with xy-coordinates. Spatial points close to each other tend to be more similar than points with greater distance between each other. Spatial cross-validation takes this into account by putting points close to each other either into the training or the test dataset (see Figure @ref(fig:ressp)).</p>
<p>For more details on (spatial) cross-validation, please refer to <span class="citation">Brenning (<a href="#ref-brenning2012" role="doc-biblioref">2012</a>)</span> and <span class="citation">Schratz et al. (<a href="#ref-schratz2019" role="doc-biblioref">2019</a>)</span>. For a gentle introduction to spatial cross-validation, please refer to Chapter 11 of <a href="https://geocompr.robinlovelace.net/spatial-cv.html">Geocomputation with R</a> <span class="citation">(Lovelace, Nowosad, and Muenchow <a href="#ref-lovelace_geocomputation_2019" role="doc-biblioref">2019</a>)</span>. In the next code chunk we execute the cross-validation again, this time taking into account the spatial dimension by using a spatial resampling method.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">resampling_sp</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">rsmp</a></span>(<span class="st">"repeated_spcv_coords"</span>, <span class="kw">folds</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">repeats</span> <span class="kw">=</span> <span class="fl">5</span>)

<span class="no">rr_sp</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/resample.html">resample</a></span>(
  <span class="kw">task</span> <span class="kw">=</span> <span class="no">ecuador</span>, <span class="kw">learner</span> <span class="kw">=</span> <span class="no">learner</span>,
  <span class="kw">resampling</span> <span class="kw">=</span> <span class="no">resampling_sp</span>)

<span class="no">rr_sp</span>$<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(<span class="kw">measures</span> <span class="kw">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">msr</a></span>(<span class="st">"classif.ce"</span>))
<span class="co">#&gt; classif.ce </span>
<span class="co">#&gt;  0.3974651</span></pre></body></html></div>
<p>It can be seen that the non-spatial CV performed better. However, “better” in this case actually means overoptimistic and <strong>biased</strong> <span class="citation">(Burman, Chow, and Nolan <a href="#ref-burman1994" role="doc-biblioref">1994</a>; Cliff and Ord <a href="#ref-cliff1970" role="doc-biblioref">1970</a>; Racine <a href="#ref-racine2000" role="doc-biblioref">2000</a>; Schratz et al. <a href="#ref-schratz2019" role="doc-biblioref">2019</a>)</span>. Hence, it is highly recommended to <strong>not</strong> use classical, non-spatial CV methods with spatiotemporal data but rather choose an appropriate spatiotemporal method.</p>
</div>
</div>
<div id="visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h2>
<p>This package also provides generic S3 <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> methods for all implemented resampling methods.</p>
<p>For an exhaustive overview, have a look at the <a href="https://mlr3spatiotempcv.mlr-org.com/reference/index.html#section-visualization">reference section for the autoplot methods</a>.</p>
<p>All methods can be visualized via the following logic:</p>
<ul>
<li>If no specific fold is specified, all partitions of a specific repetition will be returned. In this setting, each partition corresponds to one test set.</li>
<li>If a fold ID is provided via <code>fold_id</code>, the train and test sets for this given fold are visualized.</li>
<li>If multiple fold IDs are provided, a list of plots is returned, optionally arranged in a grid (<code>plot_as_grid = TRUE/FALSE</code>).</li>
</ul>
<div id="spatial" class="section level3">
<h3 class="hasAnchor">
<a href="#spatial" class="anchor"></a>Spatial</h3>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">resampling_sp</span>, <span class="kw">task</span> <span class="kw">=</span> <span class="no">ecuador</span>, <span class="kw">crs</span> <span class="kw">=</span> <span class="fl">4326</span>)</pre></body></html></div>
<div class="figure" style="text-align: center">
<img src="mlr3spatiotempcv_files/figure-html/ressp-1.png" alt="Fig.2: Example for five spatially disjoint partitions constructed with the `spcv_coords` resampling method." width="700"><p class="caption">
Fig.2: Example for five spatially disjoint partitions constructed with the <code>spcv_coords</code> resampling method.
</p>
</div>
</div>
<div id="non-spatial" class="section level3">
<h3 class="hasAnchor">
<a href="#non-spatial" class="anchor"></a>Non-spatial</h3>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">resampling_nsp</span>, <span class="kw">task</span> <span class="kw">=</span> <span class="no">ecuador</span>, <span class="kw">crs</span> <span class="kw">=</span> <span class="fl">4326</span>)</pre></body></html></div>
<p><img src="mlr3spatiotempcv_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-brenning2012">
<p>Brenning, Alexander. 2012. “Spatial cross-validation and bootstrap for the assessment of prediction rules in remote sensing: The R package sperrorest.” In <em>2012 IEEE International Geoscience and Remote Sensing Symposium</em>. IEEE. <a href="https://doi.org/10.1109/igarss.2012.6352393">https://doi.org/10.1109/igarss.2012.6352393</a>.</p>
</div>
<div id="ref-brenning_landslide_2015">
<p>Brenning, A, M Schwinn, AP Ruiz-Páez, and J Muenchow. 2015. “Landslide Susceptibility Near Highways Is Increased by 1 Order of Magnitude in the Andes of Southern Ecuador, Loja Province.” <em>Natural Hazards &amp; Earth System Sciences</em> 15 (1).</p>
</div>
<div id="ref-burman1994">
<p>Burman, Prabir, Edmond Chow, and Deborah Nolan. 1994. “A Cross-Validatory Method for Dependent Data.” <em>Biometrika</em> 81 (2): 351–58. <a href="https://doi.org/10.1093/biomet/81.2.351">https://doi.org/10.1093/biomet/81.2.351</a>.</p>
</div>
<div id="ref-cliff1970">
<p>Cliff, Andrew D., and Keith Ord. 1970. “Spatial Autocorrelation: A Review of Existing and New Measures with Applications.” <em>Economic Geography</em> 46 (June): 269. <a href="https://doi.org/10.2307/143144">https://doi.org/10.2307/143144</a>.</p>
</div>
<div id="ref-lovelace_geocomputation_2019">
<p>Lovelace, Robin, Jakub Nowosad, and Jannes Muenchow. 2019. <em>Geocomputation with R</em>. 1st ed. The R Series. Boca Raton; London; New York: Chapman; Hall/CRC. https://geocompr.robinlovelace.net/.</p>
</div>
<div id="ref-racine2000">
<p>Racine, Jeff. 2000. “Consistent Cross-Validatory Model-Selection for Dependent Data: Hv-Block Cross-Validation.” <em>Journal of Econometrics</em> 99 (1): 39–61. <a href="https://doi.org/10.1016/s0304-4076(00)00030-0">https://doi.org/10.1016/s0304-4076(00)00030-0</a>.</p>
</div>
<div id="ref-schratz2019">
<p>Schratz, Patrick, Jannes Muenchow, Eugenia Iturritxa, Jakob Richter, and Alexander Brenning. 2019. “Hyperparameter Tuning and Performance Assessment of Statistical and Machine-Learning Algorithms Using Spatial Data.” <em>Ecological Modelling</em> 406 (August): 109–20. <a href="https://doi.org/10.1016/j.ecolmodel.2019.06.002">https://doi.org/10.1016/j.ecolmodel.2019.06.002</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Please note that the “ecuador” task is also available via <code><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">tsk(ecuador)</a></code>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://pat-s.me">Patrick Schratz</a>, Marc Becker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
